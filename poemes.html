<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Po√®mes</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="favicon.ico">
    <link rel="stylesheet" href="styles.css">

    <!-- Firebase 12+ modulaire -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-app.js";
        import { getFirestore, collection, getDocs, query, orderBy, onSnapshot } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-firestore.js";

        // ta config Firebase
        const firebaseConfig = {
            apiKey: "TON_API_KEY",
            authDomain: "TON_AUTH_DOMAIN",
            projectId: "TON_PROJECT_ID"
        };
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // Elements DOM
        const poemGallery = document.getElementById("poeme-gallery");
        const modalContainer = document.getElementById("poemModal");
        const modalTitle = document.getElementById("modalTitle");
        const modalText = document.getElementById("modalText");
        const closeModalBtn = document.getElementById("closeModal");

        // Ouvrir modale
        function openModal(title, text) {
            modalTitle.textContent = title;
            modalText.textContent = text;
            modalContainer.classList.remove("hidden");
        }

        // Fermer modale
        closeModalBtn.onclick = () => modalContainer.classList.add("hidden");
        window.onclick = (e) => { if(e.target === modalContainer) modalContainer.classList.add("hidden"); };

        // R√©cup√©rer po√®mes et g√©n√©rer les cartes
        const poemsRef = collection(db, "po√®mes");
        const q = query(poemsRef, orderBy("date", "desc"));

        onSnapshot(q, (snapshot) => {
            poemGallery.innerHTML = ""; // reset
            snapshot.forEach(docSnap => {
                const poem = docSnap.data();
                const card = document.createElement("div");
                card.classList.add("poeme");
                card.style.backgroundImage = `url('${poem["bg-img"] || "https://via.placeholder.com/400"}')`;

                // Id unique pour modale si tu veux un id sp√©cifique
                const poemId = docSnap.id;

                card.innerHTML = `
                    <div class="poeme-title">${poem.title}</div>
                    <button class="view-btn" style="background-color:#1E90FF;color:white;border:none;padding:5px 10px;border-radius:5px;margin-top:5px;">Voir +</button>
                `;

                // Bouton "Voir +"
                card.querySelector(".view-btn").addEventListener("click", () => {
                    openModal(poem.title, poem.text);
                });

                poemGallery.appendChild(card);
            });
        });
    </script>
</head>
<body>
<header>
    <div class="header-top">
        <div class="logo">
            <a href="admin.html"><img src="logo.png" alt="Logo" /></a>
            <span>Andrea.com</span>
        </div>
        <div class="hamburger" onclick="toggleMenu()">MENUüçã</div>
    </div>
    <nav id="menu" class="hidden">
        <ul>
            <li><a href="index.html">Jeu de r√¥lesüíÉüèª</a></li>
            <li><a href="galerie.html">Galerie</a></li>
            <li><a href="apropos.html">A propos du site</a></li>
            <li><a href="contact.html">Contact</a></li>
            <li><a href="poemes.html">Po√®mes</a></li>
            <li><a href="jeu.html">Morpion</a></li>
        </ul>
    </nav>
    <hr class="menu-separator hidden" id="separator">
</header>

<main>
    <h1>Salut !</h1>
    <p>Depuis le temps que j'√©cris des po√®mes, je me suis dis que je pourrais t'en partager quelques-uns aujourd'hui !</p>
    <hr><br><br>
    
    <h2>Mes po√®mes</h2>
    <div class="galerie" id="poeme-gallery"></div>

    <!-- Modale unique -->
    <div id="poemModal" class="modal hidden">
        <div class="modal-content">
            <span id="closeModal" class="close">&times;</span>
            <h2 id="modalTitle"></h2>
            <p id="modalText"></p>
        </div>
    </div>
</main>

<footer>
    <div>aaaaaaa<br><br></div>
    <div style="color: peru;">aaaa</div>
</footer>

<script>
    function toggleMenu() {
        const menu = document.getElementById("menu");
        const separator = document.getElementById("separator");
        menu.classList.toggle("hidden");
        separator.classList.toggle("hidden");
    }
</script>
</body>
</html>